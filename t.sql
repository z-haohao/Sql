-- show create view dc_ods_view.yg_order_tbl_order_detail4sub_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_detail4sub_ods AS SELECT id, commodity_id, commodity_no, order_sub_id, order_main_no, prod_no, prod_name, prod_type, commodity_specification_str, commodity_num, CAST(commodity_weight AS DECIMAL(17,4)) commodity_weight, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, commodity_image, del_flag, sub_detail_no, prod_status, CAST(prod_discount_amount AS DECIMAL(17,4)) prod_discount_amount, CAST(prod_unit_price AS DECIMAL(17,4)) prod_unit_price, apply_refund_no, level_code, usable_num, gift_info, active_name, discount_number, discount_no, giving_scores, active_id, active_type, commodity_type, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(active_price AS DECIMAL(17,4)) active_price, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, CAST(postage_cost AS DECIMAL(17,4)) postage_cost, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_price AS DECIMAL(17,4)) print_price, merchant_code, third_party_delivery_time, third_party_sign_in_time, third_party_return_stock_time, CAST(pay_amount_by_cost AS DECIMAL(17,4)) pay_amount_by_cost, site_no, is_use_coupon, consume_integral, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, sale_prop, CAST(gb_cost_price AS DECIMAL(17,4)) gb_cost_price, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, split_flag, CAST(platform_pref_amount AS DECIMAL(17,4)) platform_pref_amount, sync_timestamp, intercept_type, intercept_time, fid, CAST(prod_platform_bear_amount AS DECIMAL(17,4)) prod_platform_bear_amount, CAST(terminal_price AS DECIMAL(17,4)) terminal_price, latest_delivery_date, group_id, trade_source_no, suit_code, sku_id, prod_tag, presenter_name, presenter_no, room_id, front_pay_amount, outside_commodity_id, expand_price_used, create_time, delay_delivery_time, platform_latest_delivery_date, traffic_source FROM dc_ods_kudu.yg_order_tbl_order_detail4sub_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, commodity_id, commodity_no, order_sub_id, order_main_no, prod_no, prod_name, prod_type, commodity_specification_str, commodity_num, CAST(commodity_weight AS DECIMAL(17,4)) commodity_weight, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, commodity_image, del_flag, sub_detail_no, prod_status, CAST(prod_discount_amount AS DECIMAL(17,4)) prod_discount_amount, CAST(prod_unit_price AS DECIMAL(17,4)) prod_unit_price, apply_refund_no, level_code, usable_num, gift_info, active_name, discount_number, discount_no, giving_scores, active_id, active_type, commodity_type, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(active_price AS DECIMAL(17,4)) active_price, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, CAST(postage_cost AS DECIMAL(17,4)) postage_cost, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_price AS DECIMAL(17,4)) print_price, merchant_code, third_party_delivery_time, third_party_sign_in_time, third_party_return_stock_time, CAST(pay_amount_by_cost AS DECIMAL(17,4)) pay_amount_by_cost, site_no, is_use_coupon, consume_integral, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, sale_prop, CAST(gb_cost_price AS DECIMAL(17,4)) gb_cost_price, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, split_flag, CAST(platform_pref_amount AS DECIMAL(17,4)) platform_pref_amount, sync_timestamp, intercept_type, intercept_time, fid, CAST(prod_platform_bear_amount AS DECIMAL(17,4)) prod_platform_bear_amount, CAST(terminal_price AS DECIMAL(17,4)) terminal_price, latest_delivery_date, group_id, trade_source_no, suit_code, sku_id, prod_tag, presenter_name, presenter_no, '' room_id, front_pay_amount, outside_commodity_id, expand_price_used, create_time, NULL delay_delivery_time, NULL platform_latest_delivery_date, NULL traffic_source FROM dc_ods_kudu.yg_order_tbl_order_detail4sub_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, commodity_id, commodity_no, order_sub_id, order_main_no, prod_no, prod_name, prod_type, commodity_specification_str, commodity_num, CAST(commodity_weight AS DECIMAL(17,4)) commodity_weight, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, commodity_image, del_flag, sub_detail_no, prod_status, CAST(prod_discount_amount AS DECIMAL(17,4)) prod_discount_amount, CAST(prod_unit_price AS DECIMAL(17,4)) prod_unit_price, apply_refund_no, level_code, usable_num, gift_info, active_name, discount_number, discount_no, giving_scores, active_id, active_type, commodity_type, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(active_price AS DECIMAL(17,4)) active_price, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, CAST(postage_cost AS DECIMAL(17,4)) postage_cost, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_price AS DECIMAL(17,4)) print_price, merchant_code, third_party_delivery_time, third_party_sign_in_time, third_party_return_stock_time, CAST(pay_amount_by_cost AS DECIMAL(17,4)) pay_amount_by_cost, site_no, is_use_coupon, consume_integral, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, sale_prop, CAST(gb_cost_price AS DECIMAL(17,4)) gb_cost_price, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, split_flag, CAST(platform_pref_amount AS DECIMAL(17,4)) platform_pref_amount, sync_timestamp, intercept_type, intercept_time, fid, CAST(prod_platform_bear_amount AS DECIMAL(17,4)) prod_platform_bear_amount, CAST(terminal_price AS DECIMAL(17,4)) terminal_price, latest_delivery_date, group_id, trade_source_no, suit_code, sku_id, CAST(prod_tag AS STRING), presenter_name, presenter_no, room_id, front_pay_amount, outside_commodity_id, expand_price_used, create_time, delay_delivery_time, NULL platform_latest_delivery_date, NULL traffic_source FROM dc_ods_kudu.yg_order_his_tbl_order_detail4sub_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, commodity_id, commodity_no, order_sub_id, order_main_no, prod_no, prod_name, prod_type, commodity_specification_str, commodity_num, CAST(commodity_weight AS DECIMAL(17,4)) commodity_weight, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, commodity_image, del_flag, sub_detail_no, prod_status, CAST(prod_discount_amount AS DECIMAL(17,4)) prod_discount_amount, CAST(prod_unit_price AS DECIMAL(17,4)) prod_unit_price, apply_refund_no, level_code, usable_num, gift_info, active_name, discount_number, discount_no, giving_scores, active_id, active_type, commodity_type, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(active_price AS DECIMAL(17,4)) active_price, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, CAST(postage_cost AS DECIMAL(17,4)) postage_cost, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_price AS DECIMAL(17,4)) print_price, merchant_code, third_party_delivery_time, third_party_sign_in_time, third_party_return_stock_time, CAST(pay_amount_by_cost AS DECIMAL(17,4)) pay_amount_by_cost, site_no, is_use_coupon, consume_integral, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, sale_prop, CAST(gb_cost_price AS DECIMAL(17,4)) gb_cost_price, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, split_flag, CAST(platform_pref_amount AS DECIMAL(17,4)) platform_pref_amount, sync_timestamp, intercept_type, intercept_time, fid, CAST(prod_platform_bear_amount AS DECIMAL(17,4)) prod_platform_bear_amount, CAST(terminal_price AS DECIMAL(17,4)) terminal_price, latest_delivery_date, group_id, trade_source_no, suit_code, sku_id, '' prod_tag, presenter_name, presenter_no, '' room_id, front_pay_amount, outside_commodity_id, expand_price_used, create_time, NULL delay_delivery_time, NULL platform_latest_delivery_date, NULL traffic_source FROM dc_ods_kudu.yg_order_tbl_order_detail4sub_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, commodity_id, commodity_no, order_sub_id, order_main_no, prod_no, prod_name, prod_type, commodity_specification_str, commodity_num, CAST(commodity_weight AS DECIMAL(17,4)) commodity_weight, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, commodity_image, del_flag, sub_detail_no, prod_status, CAST(prod_discount_amount AS DECIMAL(17,4)) prod_discount_amount, CAST(prod_unit_price AS DECIMAL(17,4)) prod_unit_price, apply_refund_no, level_code, usable_num, gift_info, active_name, discount_number, discount_no, giving_scores, active_id, active_type, commodity_type, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(active_price AS DECIMAL(17,4)) active_price, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, CAST(postage_cost AS DECIMAL(17,4)) postage_cost, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_price AS DECIMAL(17,4)) print_price, merchant_code, third_party_delivery_time, third_party_sign_in_time, third_party_return_stock_time, CAST(pay_amount_by_cost AS DECIMAL(17,4)) pay_amount_by_cost, site_no, is_use_coupon, consume_integral, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, sale_prop, CAST(gb_cost_price AS DECIMAL(17,4)) gb_cost_price, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, split_flag, CAST(platform_pref_amount AS DECIMAL(17,4)) platform_pref_amount, sync_timestamp, intercept_type, intercept_time, fid, CAST(prod_platform_bear_amount AS DECIMAL(17,4)) prod_platform_bear_amount, CAST(terminal_price AS DECIMAL(17,4)) terminal_price, latest_delivery_date, group_id, trade_source_no, suit_code, sku_id, CAST(prod_tag AS STRING), presenter_name, presenter_no, room_id, front_pay_amount, outside_commodity_id, expand_price_used, create_time, delay_delivery_time, NULL platform_latest_delivery_date, NULL traffic_source FROM dc_ods_kudu.yg_order_tbl_order_detail4sub_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL
;

-- show create view dc_ods_view.yg_order_tbl_order_sub_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_sub_ods AS SELECT id, order_main_id, buy_id, consignee_id, invoice_id, order_sub_no, order_main_no, giving_scores, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, active_name, original_order_no, modity_date, create_time, order_timestamp, CAST(total_price AS DECIMAL(17,4)) total_price, pay_status, delivery_status, base_status, lock_user, is_bill, is_exception, CAST(refund_amount AS DECIMAL(17,4)) refund_amount, warehouse_code, CAST(product_total_price AS DECIMAL(17,4)) product_total_price, product_total_quantity, CAST(product_weight AS DECIMAL(17,4)) product_weight, CAST(del_flag AS INT) del_flag, CAST(split_flag AS INT) split_flag, payment, order_flag, union_trace_code, suspend_type, message, CAST(pay_total_price AS DECIMAL(17,4)) pay_total_price, is_derived, warehouse_delivery_status, send_or_pay_timestamp, express_order_id, logistics_name, CAST(order_pay_total_amont AS DECIMAL(17,4)) order_pay_total_amont, logistics_code, product_send_quantity, off_pay_timestamp, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, online_payment, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(is_sync AS INT) is_sync, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, client_ip, out_order_id, out_shop_name, client_sign, cod, order_sync_time, online_pay_time, verify_user, verify_time, CAST(should_postage AS DECIMAL(17,4)) should_postage, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, is_postage_free, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, has_refund, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, ship_time, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, package_no, package_num, coupon_id, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_order_amount AS DECIMAL(17,4)) print_order_amount, CAST(print_pref_amount AS DECIMAL(17,4)) print_pref_amount, CAST(settle_type AS INT) settle_type, order_source_no, order_status, is_paid, CAST(pay_balance_price AS DECIMAL(17,4)) pay_balance_price, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, product_weight_unit, return_goods_status, apportion_status, CAST(sub_platform_bear_amount AS DECIMAL(17,4)) sub_platform_bear_amount, original_out_id, pay_method, dispatch_pool, pack_time FROM dc_ods_kudu.yg_order_tbl_order_sub_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_id, buy_id, consignee_id, invoice_id, order_sub_no, order_main_no, giving_scores, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, active_name, original_order_no, modity_date, create_time, order_timestamp, CAST(total_price AS DECIMAL(17,4)) total_price, pay_status, delivery_status, base_status, lock_user, is_bill, is_exception, CAST(refund_amount AS DECIMAL(17,4)) refund_amount, warehouse_code, CAST(product_total_price AS DECIMAL(17,4)) product_total_price, product_total_quantity, CAST(product_weight AS DECIMAL(17,4)) product_weight, CAST(del_flag AS INT) del_flag, CAST(split_flag AS INT) split_flag, payment, order_flag, union_trace_code, suspend_type, message, CAST(pay_total_price AS DECIMAL(17,4)) pay_total_price, is_derived, warehouse_delivery_status, send_or_pay_timestamp, express_order_id, logistics_name, CAST(order_pay_total_amont AS DECIMAL(17,4)) order_pay_total_amont, logistics_code, product_send_quantity, off_pay_timestamp, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, online_payment, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(is_sync AS INT) is_sync, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, client_ip, out_order_id, out_shop_name, client_sign, cod, order_sync_time, online_pay_time, verify_user, verify_time, CAST(should_postage AS DECIMAL(17,4)) should_postage, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, is_postage_free, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, has_refund, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, ship_time, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, package_no, package_num, coupon_id, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_order_amount AS DECIMAL(17,4)) print_order_amount, CAST(print_pref_amount AS DECIMAL(17,4)) print_pref_amount, CAST(settle_type AS INT) settle_type, order_source_no, order_status, is_paid, CAST(pay_balance_price AS DECIMAL(17,4)) pay_balance_price, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, product_weight_unit, return_goods_status, apportion_status, CAST(sub_platform_bear_amount AS DECIMAL(17,4)) sub_platform_bear_amount, original_out_id, pay_method, NULL dispatch_pool, NULL pack_time FROM dc_ods_kudu.yg_order_tbl_order_sub_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_id, buy_id, consignee_id, invoice_id, order_sub_no, order_main_no, giving_scores, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, active_name, original_order_no, modity_date, create_time, order_timestamp, CAST(total_price AS DECIMAL(17,4)) total_price, pay_status, delivery_status, base_status, lock_user, is_bill, is_exception, CAST(refund_amount AS DECIMAL(17,4)) refund_amount, warehouse_code, CAST(product_total_price AS DECIMAL(17,4)) product_total_price, product_total_quantity, CAST(product_weight AS DECIMAL(17,4)) product_weight, CAST(del_flag AS INT) del_flag, CAST(split_flag AS INT) split_flag, payment, order_flag, union_trace_code, suspend_type, message, CAST(pay_total_price AS DECIMAL(17,4)) pay_total_price, is_derived, warehouse_delivery_status, send_or_pay_timestamp, express_order_id, logistics_name, CAST(order_pay_total_amont AS DECIMAL(17,4)) order_pay_total_amont, logistics_code, product_send_quantity, off_pay_timestamp, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, online_payment, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(is_sync AS INT) is_sync, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, client_ip, out_order_id, out_shop_name, client_sign, cod, order_sync_time, online_pay_time, verify_user, verify_time, CAST(should_postage AS DECIMAL(17,4)) should_postage, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, is_postage_free, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, has_refund, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, ship_time, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, package_no, package_num, coupon_id, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_order_amount AS DECIMAL(17,4)) print_order_amount, CAST(print_pref_amount AS DECIMAL(17,4)) print_pref_amount, CAST(settle_type AS INT) settle_type, order_source_no, order_status, is_paid, CAST(pay_balance_price AS DECIMAL(17,4)) pay_balance_price, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, product_weight_unit, return_goods_status, apportion_status, CAST(sub_platform_bear_amount AS DECIMAL(17,4)) sub_platform_bear_amount, original_out_id, pay_method, dispatch_pool, NULL pack_time FROM dc_ods_kudu.yg_order_tbl_order_sub_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_id, buy_id, consignee_id, invoice_id, order_sub_no, order_main_no, giving_scores, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, active_name, original_order_no, modity_date, create_time, order_timestamp, CAST(total_price AS DECIMAL(17,4)) total_price, pay_status, delivery_status, base_status, lock_user, is_bill, is_exception, CAST(refund_amount AS DECIMAL(17,4)) refund_amount, warehouse_code, CAST(product_total_price AS DECIMAL(17,4)) product_total_price, product_total_quantity, CAST(product_weight AS DECIMAL(17,4)) product_weight, CAST(del_flag AS INT) del_flag, CAST(split_flag AS INT) split_flag, payment, order_flag, union_trace_code, suspend_type, message, CAST(pay_total_price AS DECIMAL(17,4)) pay_total_price, is_derived, warehouse_delivery_status, send_or_pay_timestamp, express_order_id, logistics_name, CAST(order_pay_total_amont AS DECIMAL(17,4)) order_pay_total_amont, logistics_code, product_send_quantity, off_pay_timestamp, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, online_payment, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(is_sync AS INT) is_sync, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, client_ip, out_order_id, out_shop_name, client_sign, cod, order_sync_time, online_pay_time, verify_user, verify_time, CAST(should_postage AS DECIMAL(17,4)) should_postage, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, is_postage_free, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, has_refund, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, ship_time, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, package_no, package_num, coupon_id, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_order_amount AS DECIMAL(17,4)) print_order_amount, CAST(print_pref_amount AS DECIMAL(17,4)) print_pref_amount, CAST(settle_type AS INT) settle_type, order_source_no, order_status, is_paid, CAST(pay_balance_price AS DECIMAL(17,4)) pay_balance_price, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, product_weight_unit, return_goods_status, apportion_status, CAST(sub_platform_bear_amount AS DECIMAL(17,4)) sub_platform_bear_amount, original_out_id, pay_method, dispatch_pool, pack_time FROM dc_ods_kudu.yg_order_his_tbl_order_sub_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_id, buy_id, consignee_id, invoice_id, order_sub_no, order_main_no, giving_scores, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, active_name, original_order_no, modity_date, create_time, order_timestamp, CAST(total_price AS DECIMAL(17,4)) total_price, pay_status, delivery_status, base_status, lock_user, is_bill, is_exception, CAST(refund_amount AS DECIMAL(17,4)) refund_amount, warehouse_code, CAST(product_total_price AS DECIMAL(17,4)) product_total_price, product_total_quantity, CAST(product_weight AS DECIMAL(17,4)) product_weight, CAST(del_flag AS INT) del_flag, CAST(split_flag AS INT) split_flag, payment, order_flag, union_trace_code, suspend_type, message, CAST(pay_total_price AS DECIMAL(17,4)) pay_total_price, is_derived, warehouse_delivery_status, send_or_pay_timestamp, express_order_id, logistics_name, CAST(order_pay_total_amont AS DECIMAL(17,4)) order_pay_total_amont, logistics_code, product_send_quantity, off_pay_timestamp, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, online_payment, CAST(active_pref_amount AS DECIMAL(17,4)) active_pref_amount, CAST(member_pref_amount AS DECIMAL(17,4)) member_pref_amount, CAST(coupon_pref_amount AS DECIMAL(17,4)) coupon_pref_amount, CAST(is_sync AS INT) is_sync, CAST(temp_sale_amount AS DECIMAL(17,4)) temp_sale_amount, client_ip, out_order_id, out_shop_name, client_sign, cod, order_sync_time, online_pay_time, verify_user, verify_time, CAST(should_postage AS DECIMAL(17,4)) should_postage, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, is_postage_free, CAST(payment_pref_amount AS DECIMAL(17,4)) payment_pref_amount, has_refund, CAST(coupon_pref_amount5 AS DECIMAL(17,4)) coupon_pref_amount5, ship_time, CAST(buy_reduction_pref_amount AS DECIMAL(17,4)) buy_reduction_pref_amount, package_no, package_num, coupon_id, CAST(integral_pref_amount AS DECIMAL(17,4)) integral_pref_amount, CAST(globle_pref_amount AS DECIMAL(17,4)) globle_pref_amount, CAST(print_order_amount AS DECIMAL(17,4)) print_order_amount, CAST(print_pref_amount AS DECIMAL(17,4)) print_pref_amount, CAST(settle_type AS INT) settle_type, order_source_no, order_status, is_paid, CAST(pay_balance_price AS DECIMAL(17,4)) pay_balance_price, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, product_weight_unit, return_goods_status, apportion_status, CAST(sub_platform_bear_amount AS DECIMAL(17,4)) sub_platform_bear_amount, original_out_id, pay_method, dispatch_pool, pack_time FROM dc_ods_kudu.yg_order_tbl_order_sub_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

--show create view dc_ods_view.yg_order_tbl_order_main_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_main_ods AS SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, insert_time FROM dc_ods_kudu.yg_order_tbl_order_main_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_tbl_order_main_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_tbl_order_main_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_his_tbl_order_main_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, insert_time FROM dc_ods_kudu.yg_order_tbl_order_main_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_his_tbl_order_main_2017_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_his_tbl_order_main_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, member_name, member_no, prod_total_num, CAST(prod_total_amt AS DECIMAL(17,4)) prod_total_amt, payment, create_time, total_giving_scores, promotional_programs, CAST(total_preferential_amount AS DECIMAL(17,4)) total_preferential_amount, order_message, del_flag, order_flag, union_type, pay_status, buy_id, consignee_id, CAST(online_pay_amount AS DECIMAL(17,4)) online_pay_amount, client_sign, CAST(order_total_amt AS DECIMAL(17,4)) order_total_amt, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, coupon_id, global_active_id, to_account_time, CAST(to_account_amount AS DECIMAL(17,4)) to_account_amount, CAST(royalty_rate AS DECIMAL(17,4)) royalty_rate, CAST(tax_amount AS DECIMAL(17,4)) tax_amount, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, reserve_time, split_flag, lock_user, coupon_scheme_id, coupon_scheme_name, NULL insert_time FROM dc_ods_kudu.yg_order_his_tbl_order_main_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_sub_expand_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_sub_expand_ods AS SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(delay_review_type AS STRING) delay_review_type, CAST(explosive_flag AS STRING) explosive_flag, CAST(merged_order_status AS STRING) merged_order_status, ship_time_require, delivery_sync_status, create_time, outside_owner_no, delivery_dept_name, delivery_dept_no, region, region_no, manage_city, manage_city_no, city_token, CAST(collect_date AS STRING) collect_date, delivery_dept_settle_code, delivery_dept_settle_name, express_pro_type, notice_work_type, split_original_order_no, third_shop_id, shop_app_id, delivery_assessment_time, risk_reason, update_time, split_out_orders, delivery_store_name FROM dc_ods_kudu.yg_order_tbl_order_sub_expand_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(NULL AS STRING) delay_review_type, CAST(NULL AS STRING) explosive_flag, NULL merged_order_status, ship_time_require, delivery_sync_status, create_time, outside_owner_no, delivery_dept_name, delivery_dept_no, region, region_no, manage_city, manage_city_no, city_token, CAST(collect_date AS STRING) collect_date, delivery_dept_settle_code, delivery_dept_settle_name, express_pro_type, notice_work_type, split_original_order_no, third_shop_id, NULL shop_app_id, NULL delivery_assessment_time, NULL risk_reason, NULL update_time, NULL split_out_orders, NULL delivery_store_name FROM dc_ods_kudu.yg_order_tbl_order_sub_expand_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(NULL AS STRING) delay_review_type, CAST(NULL AS STRING) explosive_flag, NULL merged_order_status, ship_time_require, delivery_sync_status, create_time, outside_owner_no, delivery_dept_name, delivery_dept_no, region, region_no, manage_city, manage_city_no, city_token, NULL, delivery_dept_settle_code, delivery_dept_settle_name, NULL, notice_work_type, split_original_order_no, NULL, NULL shop_app_id, NULL delivery_assessment_time, NULL risk_reason, NULL update_time, NULL split_out_orders, NULL delivery_store_name FROM dc_ods_kudu.yg_order_his_tbl_order_sub_expand_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(NULL AS STRING) delay_review_type, CAST(NULL AS STRING) explosive_flag, NULL merged_order_status, ship_time_require, delivery_sync_status, create_time, outside_owner_no, delivery_dept_name, delivery_dept_no, region, region_no, manage_city, manage_city_no, city_token, NULL, delivery_dept_settle_code, delivery_dept_settle_name, NULL, notice_work_type, split_original_order_no, NULL, NULL shop_app_id, NULL delivery_assessment_time, NULL risk_reason, NULL update_time, NULL split_out_orders, NULL delivery_store_name FROM dc_ods_kudu.yg_order_tbl_order_sub_expand_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(NULL AS STRING) delay_review_type, CAST(NULL AS STRING) explosive_flag, NULL merged_order_status, ship_time_require, delivery_sync_status, create_time, outside_owner_no, delivery_dept_name, delivery_dept_no, region, region_no, manage_city, manage_city_no, city_token, NULL, NULL, NULL, NULL, notice_work_type, NULL, NULL, NULL shop_app_id, NULL delivery_assessment_time, NULL risk_reason, NULL update_time, NULL split_out_orders, NULL delivery_store_name FROM dc_ods_kudu.yg_order_tbl_order_sub_expand_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT CAST(id AS STRING) id, CAST(order_sub_id AS STRING) order_sub_id, CAST(order_distribution_side AS INT) order_distribution_side, CAST(order_exported_status AS INT) order_exported_status, CAST(exported_date AS STRING) exported_date, CAST(stocking_date AS STRING) stocking_date, CAST(backorder_date AS STRING) backorder_date, CAST(backup_no AS STRING) backup_no, CAST(channel_no AS STRING) channel_no, CAST(reject_time AS STRING) reject_time, CAST(order_printed_status AS INT) order_printed_status, CAST(print_shoppinglist_count AS INT) print_shoppinglist_count, CAST(print_logisticslist_count AS INT) print_logisticslist_count, CAST(cancel_type AS INT) cancel_type, CAST(cancel_reason AS STRING) cancel_reason, CAST(merchant_code AS STRING) merchant_code, CAST(is_part_deliver AS INT) is_part_deliver, CAST(insert_time AS STRING) insert_time, CAST(postage_on_delivery AS INT) postage_on_delivery, CAST(pre_sale_order AS INT) pre_sale_order, CAST(earnest_money AS DECIMAL(17,4)) earnest_money, CAST(earnest_money_date AS STRING) earnest_money_date, CAST(balance_due_date AS STRING) balance_due_date, CAST(default_delivery_date AS STRING) default_delivery_date, CAST(fx_name AS STRING) fx_name, CAST(invoice_follow_order AS INT) invoice_follow_order, CAST(inventory_preempted AS INT) inventory_preempted, CAST(intercept_type AS INT) intercept_type, CAST(op_timestamp AS STRING) op_timestamp, CAST(order_type AS INT) order_type, CAST(intercept_time AS STRING) intercept_time, CAST(is_sync_preemption AS INT) is_sync_preemption, CAST(sync_preemption_time AS STRING) sync_preemption_time, CAST(sync_timestamp AS BIGINT) sync_timestamp, CAST(from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') AS STRING) ods_update_time, CAST(return_warehouse_code AS STRING) return_warehouse_code, CAST(expresscode_update_time AS STRING) expresscode_update_time, CAST(sale_store AS STRING) sale_store, CAST(delivery_store AS STRING) delivery_store, CAST(fetch_code AS STRING) fetch_code, CAST(receive_time AS STRING) receive_time, CAST(pack_demand AS INT) pack_demand, CAST(delivery_demand AS STRING) delivery_demand, CAST(logistics_type AS INT) logistics_type, CAST(pay_way AS INT) pay_way, CAST(delivery_deadline AS STRING) delivery_deadline, CAST(schedule_id AS STRING) schedule_id, CAST(out_side_create_time AS STRING) out_side_create_time, CAST(is_single_sale_link AS INT) is_single_sale_link, CAST(order_biz_flag AS INT) order_biz_flag, CAST(out_side_order_type AS INT) out_side_order_type, CAST(intercept_complete_time AS STRING) intercept_complete_time, CAST(intercept_status AS INT) intercept_status, CAST(delay_review_time AS STRING) delay_review_time, CAST(delivery_permit AS INT) delivery_permit, CAST(intercept_reason AS STRING) intercept_reason, CAST(real_pre_timestamp AS BIGINT) real_pre_timestamp, CAST(real_pre_status AS INT) real_pre_status, CAST(NULL AS STRING) delay_review_type, CAST(NULL AS STRING) explosive_flag, NULL merged_order_status, ship_time_require, delivery_sync_status, create_time, NULL outside_owner_no, NULL delivery_dept_name, NULL delivery_dept_no, NULL region, NULL region_no, NULL manage_city, NULL manage_city_no, city_token, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL shop_app_id, NULL delivery_assessment_time, NULL risk_reason, NULL update_time, NULL split_out_orders, NULL delivery_store_name FROM dc_ods_kudu.yg_order_his_tbl_order_sub_expand_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL


-- show create view dc_ods_view.yg_order_tbl_order_consignee_info_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_consignee_info_ods AS SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, oaid_source_code, street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, NULL company_id, NULL encrypt_channel, NULL oaid, NULL locked_flag, NULL locked_time, NULL oaid_source_code, NULL street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, NULL oaid_source_code, NULL street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, NULL oaid_source_code, NULL street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, oaid_source_code, NULL street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, oaid_source_code, street_name FROM dc_ods_kudu.yg_order_his_tbl_order_consignee_info_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, user_name, constact_phone, email, mobile_phone, delivery_date, zip_code, area, consignee_address, province, city, ship_method, is_urgent, CAST(delivery_costs AS DECIMAL(17,4)) delivery_costs, del_flag, split_flag, consignee_no, order_main_no, area_name, id_card_no, op_timestamp, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, create_time, company_id, encrypt_channel, oaid, locked_flag, locked_time, oaid_source_code, NULL street_name FROM dc_ods_kudu.yg_order_tbl_order_consignee_info_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_detail_delivery_info_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_detail_delivery_info_ods AS SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_tbl_order_detail_delivery_info_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_main_no, order_sub_no, order_detail4sub_id, express_code, logistics_code, logistics_name, warehouse_name, prod_no, commodity_num, CAST(weight AS DECIMAL(17,4)) weight, create_time, delivery_time, merchant_settle_code, merchant_cargo_code, warehouse_code, strorage_no, CAST(delivery_type AS STRING) delivery_type, delivery_dept_no, delivery_dept_name, delivery_dept_settle_code, delivery_dept_settle_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp, logistics_warehouse_no, logistics_warehouse_name, box_no, sales_dept_settle_code, sales_dept_settle_name FROM dc_ods_kudu.yg_order_his_tbl_order_detail_delivery_info_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.retail_pos_return_exchange_main_ods;
result
CREATE VIEW dc_ods_view.retail_pos_return_exchange_main_ods AS SELECT id, company_no, company_name, business_no, ref_bill_no, shop_no, shop_name, out_date, old_out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, business_mode, business_type, order_source, daily_flag, daily_datetime, balance_no, monthly_flag, monthly_datetime, old_order_no, new_order_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, express_no, logistics_no, take_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, zone_yyyymm, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, pay_time, place_date, refund_type, refund_status, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, return_audit_state, return_auditor, return_audit_time, member_id, out_time, biz_type_code, biz_type_name, client_no, client_name, card_no_bg, return_in_source, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, red_invoice_code, employee_child_card_no, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(system_source AS DECIMAL(4,0)) system_source, employee_card_code, employee_card_type, CAST(guide_order_flag AS DECIMAL(4,0)) guide_order_flag, order_schedule, quality_checking_date, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, return_type, serial_no, mall_score_flag, batch_no, special_code, po_no, sub_order_type, private_sale, sales_performance_shop_no, headless_order_no, custom_sign, sales_performance_shop_name, follow_result_type, quality_check_no, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, supply_return_no, return_audit_refuse_reason, ref_return_no, logistics_mode, notice_flag, dispatch_flag, sync_isp_flag, order_refuse_count, order_type FROM dc_ods_kudu.retail_pos_return_exchange_main_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, business_no, ref_bill_no, shop_no, shop_name, out_date, old_out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, business_mode, business_type, order_source, daily_flag, daily_datetime, balance_no, monthly_flag, monthly_datetime, old_order_no, new_order_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, express_no, logistics_no, take_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, zone_yyyymm, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, pay_time, place_date, refund_type, refund_status, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, return_audit_state, return_auditor, return_audit_time, member_id, out_time, biz_type_code, biz_type_name, client_no, client_name, card_no_bg, return_in_source, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, red_invoice_code, employee_child_card_no, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(system_source AS DECIMAL(4,0)) system_source, employee_card_code, employee_card_type, CAST(guide_order_flag AS DECIMAL(4,0)) guide_order_flag, order_schedule, quality_checking_date, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, return_type, serial_no, mall_score_flag, batch_no, special_code, po_no, sub_order_type, private_sale, sales_performance_shop_no, headless_order_no, custom_sign, sales_performance_shop_name, follow_result_type, quality_check_no, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, supply_return_no, '' return_audit_refuse_reason, NULL ref_return_no, NULL logistics_mode, NULL notice_flag, NULL dispatch_flag, NULL sync_isp_flag, NULL order_refuse_count, NULL order_type FROM dc_ods_kudu.retail_pos_return_exchange_main_his_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, business_no, ref_bill_no, shop_no, shop_name, out_date, old_out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, business_mode, business_type, order_source, daily_flag, daily_datetime, balance_no, monthly_flag, monthly_datetime, old_order_no, new_order_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, express_no, logistics_no, take_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, zone_yyyymm, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, pay_time, place_date, refund_type, refund_status, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, return_audit_state, return_auditor, return_audit_time, member_id, out_time, biz_type_code, biz_type_name, client_no, client_name, card_no_bg, return_in_source, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, red_invoice_code, employee_child_card_no, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(system_source AS DECIMAL(4,0)) system_source, employee_card_code, employee_card_type, CAST(guide_order_flag AS DECIMAL(4,0)) guide_order_flag, order_schedule, quality_checking_date, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, return_type, serial_no, mall_score_flag, batch_no, special_code, po_no, sub_order_type, private_sale, sales_performance_shop_no, headless_order_no, custom_sign, sales_performance_shop_name, follow_result_type, quality_check_no, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, supply_return_no, return_audit_refuse_reason, NULL ref_return_no, NULL logistics_mode, NULL notice_flag, NULL dispatch_flag, NULL sync_isp_flag, NULL order_refuse_count, NULL order_type FROM dc_ods_kudu.retail_pos_return_exchange_main_his_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, business_no, ref_bill_no, shop_no, shop_name, out_date, old_out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, business_mode, business_type, order_source, daily_flag, daily_datetime, balance_no, monthly_flag, monthly_datetime, old_order_no, new_order_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, express_no, logistics_no, take_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, zone_yyyymm, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, pay_time, place_date, refund_type, refund_status, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, return_audit_state, return_auditor, return_audit_time, member_id, out_time, biz_type_code, biz_type_name, client_no, client_name, card_no_bg, return_in_source, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, red_invoice_code, employee_child_card_no, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(system_source AS DECIMAL(4,0)) system_source, employee_card_code, employee_card_type, CAST(guide_order_flag AS DECIMAL(4,0)) guide_order_flag, order_schedule, quality_checking_date, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, return_type, serial_no, mall_score_flag, batch_no, special_code, po_no, sub_order_type, private_sale, sales_performance_shop_no, headless_order_no, custom_sign, sales_performance_shop_name, follow_result_type, quality_check_no, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, supply_return_no, return_audit_refuse_reason, ref_return_no, NULL logistics_mode, NULL notice_flag, NULL dispatch_flag, NULL sync_isp_flag, NULL order_refuse_count, NULL order_type FROM dc_ods_kudu.retail_pos_return_exchange_main_his_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.retail_pos_return_exchange_dtl_ods;
result
CREATE VIEW dc_ods_view.retail_pos_return_exchange_dtl_ods AS SELECT id, business_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, available_flag, CAST(item_discount AS DECIMAL(17,4)) item_discount, reason, reason_class_name, reason_class_no, reason_code, order_dtl_id, color_no, color_name, brand_name, size_kind, category_no, return_flag, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, order_taking, express_no, logistics_no, logistics_name, check_user_no, check_user, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, plate_code, service_type_no, service_type_name, company_no_from, company_name_from, across_sale_flag, return_audit_state, return_auditor, return_audit_time, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, customed_flag, customed_group_num, CAST(cash_real_buy_amount AS DECIMAL(17,4)) cash_real_buy_amount, CAST(cash_surplus_amount AS DECIMAL(17,4)) cash_surplus_amount, yougou_order_dtl_id, extend_item_no, extend_barcode, CAST(supply_price AS DECIMAL(17,4)) supply_price, from_type, manual_change_shop, flyshoe_flag, dtl_refund_status, pickup_date, order_refuse_count, dest_code FROM dc_ods_kudu.retail_pos_return_exchange_dtl_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, business_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, available_flag, CAST(item_discount AS DECIMAL(17,4)) item_discount, reason, reason_class_name, reason_class_no, reason_code, order_dtl_id, color_no, color_name, brand_name, size_kind, category_no, return_flag, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, order_taking, express_no, logistics_no, logistics_name, check_user_no, check_user, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, plate_code, service_type_no, service_type_name, company_no_from, company_name_from, across_sale_flag, return_audit_state, return_auditor, return_audit_time, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, customed_flag, customed_group_num, CAST(cash_real_buy_amount AS DECIMAL(17,4)) cash_real_buy_amount, CAST(cash_surplus_amount AS DECIMAL(17,4)) cash_surplus_amount, yougou_order_dtl_id, extend_item_no, extend_barcode, CAST(supply_price AS DECIMAL(17,4)) supply_price, NULL from_type, NULL manual_change_shop, NULL flyshoe_flag, NULL dtl_refund_status, NULL pickup_date, NULL order_refuse_count, NULL dest_code FROM dc_ods_kudu.retail_pos_return_exchange_dtl_his_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, business_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, available_flag, CAST(item_discount AS DECIMAL(17,4)) item_discount, reason, reason_class_name, reason_class_no, reason_code, order_dtl_id, color_no, color_name, brand_name, size_kind, category_no, return_flag, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, order_taking, express_no, logistics_no, logistics_name, check_user_no, check_user, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, plate_code, service_type_no, service_type_name, company_no_from, company_name_from, across_sale_flag, return_audit_state, return_auditor, return_audit_time, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, customed_flag, customed_group_num, CAST(cash_real_buy_amount AS DECIMAL(17,4)) cash_real_buy_amount, CAST(cash_surplus_amount AS DECIMAL(17,4)) cash_surplus_amount, yougou_order_dtl_id, extend_item_no, extend_barcode, CAST(supply_price AS DECIMAL(17,4)) supply_price, NULL from_type, NULL manual_change_shop, NULL flyshoe_flag, NULL dtl_refund_status, NULL pickup_date, NULL order_refuse_count, NULL dest_code FROM dc_ods_kudu.retail_pos_return_exchange_dtl_his_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, business_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, available_flag, CAST(item_discount AS DECIMAL(17,4)) item_discount, reason, reason_class_name, reason_class_no, reason_code, order_dtl_id, color_no, color_name, brand_name, size_kind, category_no, return_flag, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, order_taking, express_no, logistics_no, logistics_name, check_user_no, check_user, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, plate_code, service_type_no, service_type_name, company_no_from, company_name_from, across_sale_flag, return_audit_state, return_auditor, return_audit_time, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, customed_flag, customed_group_num, CAST(cash_real_buy_amount AS DECIMAL(17,4)) cash_real_buy_amount, CAST(cash_surplus_amount AS DECIMAL(17,4)) cash_surplus_amount, yougou_order_dtl_id, extend_item_no, extend_barcode, CAST(supply_price AS DECIMAL(17,4)) supply_price, NULL from_type, NULL manual_change_shop, NULL flyshoe_flag, NULL dtl_refund_status, NULL pickup_date, NULL order_refuse_count, NULL dest_code FROM dc_ods_kudu.retail_pos_return_exchange_dtl_his_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.retail_pos_order_main_ods;
result
CREATE VIEW dc_ods_view.retail_pos_order_main_ods AS SELECT id, company_no, company_name, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, serial_no, out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, order_type, business_type, biz_type_code, biz_type_name, order_source, daily_flag, daily_datetime, monthly_flag, monthly_datetime, balance_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, message_code, express_company, bill_transfer_no, express_no, logistics_no, take_mode, logistics_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_apply_no, invoice_apply_date, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, pickup_date, zone_yyyymm, check_user_no, check_user, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, notice_user, notice_time, notice_flag, pay_time, refund_status, place_date, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, member_id, out_time, client_no, client_name, dispatch_flag, sync_isp_flag, card_no_bg, return_in_source, order_refuse_count, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, po_no, order_schedule, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, red_invoice_code, blue_invoice_code, lasted_delivery_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, employee_child_card_no, system_source, employee_card_code, employee_card_type, delivery_mode, guide_order_flag, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, fetch_code, mall_score_flag, custom_sign, private_sale, sales_performance_shop_no, return_type, headless_order_no, batch_no, group_buy_code, special_code, sub_order_type, sales_performance_shop_name, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, virtual_store_no FROM dc_ods_kudu.retail_pos_order_main_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, serial_no, out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, order_type, business_type, biz_type_code, biz_type_name, order_source, daily_flag, daily_datetime, monthly_flag, monthly_datetime, balance_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, message_code, express_company, bill_transfer_no, express_no, logistics_no, take_mode, logistics_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_apply_no, invoice_apply_date, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, pickup_date, zone_yyyymm, check_user_no, check_user, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, notice_user, notice_time, notice_flag, pay_time, refund_status, place_date, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, member_id, out_time, client_no, client_name, dispatch_flag, sync_isp_flag, card_no_bg, return_in_source, order_refuse_count, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, po_no, order_schedule, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, red_invoice_code, blue_invoice_code, lasted_delivery_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, employee_child_card_no, system_source, employee_card_code, employee_card_type, delivery_mode, guide_order_flag, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, fetch_code, mall_score_flag, custom_sign, private_sale, sales_performance_shop_no, return_type, headless_order_no, batch_no, group_buy_code, special_code, sub_order_type, sales_performance_shop_name, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, NULL virtual_store_no FROM dc_ods_kudu.retail_pos_order_main_his_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, serial_no, out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, order_type, business_type, biz_type_code, biz_type_name, order_source, daily_flag, daily_datetime, monthly_flag, monthly_datetime, balance_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, message_code, express_company, bill_transfer_no, express_no, logistics_no, take_mode, logistics_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_apply_no, invoice_apply_date, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, pickup_date, zone_yyyymm, check_user_no, check_user, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, notice_user, notice_time, notice_flag, pay_time, refund_status, place_date, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, member_id, out_time, client_no, client_name, dispatch_flag, sync_isp_flag, card_no_bg, return_in_source, order_refuse_count, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, po_no, order_schedule, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, red_invoice_code, blue_invoice_code, lasted_delivery_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, employee_child_card_no, system_source, employee_card_code, employee_card_type, delivery_mode, guide_order_flag, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, fetch_code, mall_score_flag, custom_sign, private_sale, sales_performance_shop_no, return_type, headless_order_no, batch_no, group_buy_code, special_code, sub_order_type, sales_performance_shop_name, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, virtual_store_no FROM dc_ods_kudu.retail_pos_order_main_his_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, company_no, company_name, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, serial_no, out_date, qty, CAST(tag_price_amount AS DECIMAL(17,4)) tag_price_amount, CAST(sale_price_amount AS DECIMAL(17,4)) sale_price_amount, CAST(disc_price_amount AS DECIMAL(17,4)) disc_price_amount, CAST(settle_amount AS DECIMAL(17,4)) settle_amount, CAST(reduce_amount AS DECIMAL(17,4)) reduce_amount, CAST(total_rebate_amount AS DECIMAL(17,4)) total_rebate_amount, CAST(pref_amount AS DECIMAL(17,4)) pref_amount, CAST(coupon_amount AS DECIMAL(17,4)) coupon_amount, CAST(all_amount AS DECIMAL(17,4)) all_amount, CAST(amount AS DECIMAL(17,4)) amount, CAST(remain_amount AS DECIMAL(17,4)) remain_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, assistant_name, assistant_id, assistant_no, vip_no, vip_brand_no, vip_name, vip_phone, wildcard_no, wildcard_name, CAST(wildcard_discount AS DECIMAL(17,4)) wildcard_discount, base_score, pro_score, cost_score, order_type, business_type, biz_type_code, biz_type_name, order_source, daily_flag, daily_datetime, monthly_flag, monthly_datetime, balance_no, remark, status, CAST(actual_postage AS DECIMAL(17,4)) actual_postage, message_code, express_company, bill_transfer_no, express_no, logistics_no, take_mode, logistics_mode, market_ticket_no, lock_flag, return_exchange_time, shop_terminal_no, invoice_apply_no, invoice_apply_date, invoice_no, CAST(invoice_amount AS DECIMAL(17,4)) invoice_amount, invoice_date, pickup_date, zone_yyyymm, check_user_no, check_user, create_user_no, create_user, create_time, update_user_no, update_user, update_time, adjust_flag, adjust_user, adjust_time, adjust_order_reason, reason_class_name, reason_class_no, reason_code, responsibility_name, responsibility_no, responsibility_id, sharding_flag, remain_score, accumulated_score, notice_user, notice_time, notice_flag, pay_time, refund_status, place_date, reprint, adjust_inventory_flag, platform_no, platform_name, delivery_time, delivery_date, invoice_type, invoice_unit, invoice_content, is_package_mail_flag, member_id, out_time, client_no, client_name, dispatch_flag, sync_isp_flag, card_no_bg, return_in_source, order_refuse_count, CAST(customer_settle_price_amount AS DECIMAL(17,4)) customer_settle_price_amount, employee_card_no, CAST(employee_card_pref_price_amount AS DECIMAL(17,4)) employee_card_pref_price_amount, po_no, order_schedule, topmall_no, verification_code, face_id, CAST(third_ticket_all_amount AS DECIMAL(17,4)) third_ticket_all_amount, random_code, red_invoice_code, blue_invoice_code, lasted_delivery_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, employee_child_card_no, system_source, employee_card_code, employee_card_type, delivery_mode, guide_order_flag, CAST(vip_pref_amount AS DECIMAL(17,4)) vip_pref_amount, fetch_code, mall_score_flag, custom_sign, private_sale, sales_performance_shop_no, return_type, headless_order_no, batch_no, group_buy_code, special_code, sub_order_type, sales_performance_shop_name, exchange_curr_code, CAST(exchange_amount AS DECIMAL(17,4)) exchange_amount, bookkeeping_third_flag, virtual_store_no FROM dc_ods_kudu.retail_pos_order_main_his_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.retail_pos_order_dtl_ods;
result
CREATE VIEW dc_ods_view.retail_pos_order_dtl_ods AS SELECT id, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, CAST(item_discount AS DECIMAL(17,4)) item_discount, color_no, color_name, brand_name, reduce_price_reason, reason_class_name, reason_class_no, reason_code, size_kind, category_no, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, across_sale_flag, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, dtl_refund_status, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, express_no, logistics_no, logistics_name, pickup_date, check_user_no, check_user, message_code, order_taking, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, from_type, dest_code, plate_code, manual_change_shop, order_refuse_count, service_type_no, service_type_name, company_no_from, company_name_from, grab_order, inventory_status, flyshoe_flag, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, customed_flag, customed_group_num, yougou_order_dtl_id, CAST(supply_price AS DECIMAL(17,4)) supply_price FROM dc_ods_kudu.retail_pos_order_dtl_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_no, ref_bill_no, shop_no, shop_name, shop_no_from, shop_name_from, sku_no, item_no, size_no, item_code, item_name, barcode, brand_no, item_flag, CAST(tag_price AS DECIMAL(17,4)) tag_price, CAST(sale_price AS DECIMAL(17,4)) sale_price, CAST(disc_price AS DECIMAL(17,4)) disc_price, CAST(settle_price AS DECIMAL(17,4)) settle_price, CAST(reduce_price AS DECIMAL(17,4)) reduce_price, CAST(rebate_amount AS DECIMAL(17,4)) rebate_amount, CAST(score_amount AS DECIMAL(17,4)) score_amount, qty, CAST(amount AS DECIMAL(17,4)) amount, CAST(pref_price AS DECIMAL(17,4)) pref_price, pro_no, pro_name, special_sell_flag, CAST(discount AS DECIMAL(17,4)) discount, discount_code, discount_name, discount_type, discount_type_name, discount_source_id, billing_code, properties, virtual_flag, CAST(strength AS DECIMAL(17,4)) strength, activity_type_name, activity_type, launch_type_name, launch_type, pro_end_time, pro_start_time, balance_base, CAST(vip_discount AS DECIMAL(17,4)) vip_discount, vip_level_name, vip_level_code, base_score, pro_score, cost_score, CAST(item_discount AS DECIMAL(17,4)) item_discount, color_no, color_name, brand_name, reduce_price_reason, reason_class_name, reason_class_no, reason_code, size_kind, category_no, bill_transfer_no, price_change_bill_no, return_exchange_num, zone_yyyymm, across_sale_flag, specified_discount_flag, pickup_status, take_off_type, pickup_user, pickup_user_no, pickup_time, invoice_no, CAST(actual_amount AS DECIMAL(17,4)) actual_amount, CAST(real_buy_amount AS DECIMAL(17,4)) real_buy_amount, CAST(surplus_amount AS DECIMAL(17,4)) surplus_amount, CAST(rate_discount AS DECIMAL(17,4)) rate_discount, dtl_refund_status, create_user, create_time, update_user, update_time, sharding_flag, style_no, change_state, change_audit_state, change_state_audit_user, change_state_audit_time, rate_pro_no, rate_pro_name, biz_city_no, biz_city_name, organ_no, organ_name, zone_code, zone_name, brand_unit_no, brand_unit_name, years, region_no, region_name, remark, item_style_no, item_series_no, style_series_name, management_area_no, management_area_name, express_no, logistics_no, logistics_name, pickup_date, check_user_no, check_user, message_code, order_taking, order_taking_time, express_inbound_time, item_flag_new, inventory_nearby_reason, order_refuse_reason, order_refuse_shop_name, order_refuse_time, change_shop_no_from_time, station_id, station_name, express_sign_time, from_type, dest_code, plate_code, manual_change_shop, order_refuse_count, service_type_no, service_type_name, company_no_from, company_name_from, grab_order, inventory_status, flyshoe_flag, province_no, province_name, out_date, CAST(customer_settle_price AS DECIMAL(17,4)) customer_settle_price, member_property, virtual_activityflag, CAST(employee_card_pref_price AS DECIMAL(17,4)) employee_card_pref_price, is_buy_out, CAST(use_amount_limit AS DECIMAL(17,4)) use_amount_limit, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, CAST(third_ticket_amount AS DECIMAL(17,4)) third_ticket_amount, CAST(contract_discount AS DECIMAL(17,4)) contract_discount, customed_flag, customed_group_num, yougou_order_dtl_id, CAST(supply_price AS DECIMAL(17,4)) supply_price FROM dc_ods_kudu.retail_pos_order_dtl_his_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_warehouse_flow_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_warehouse_flow_ods AS SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_order_warehouse_flow_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, NULL update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_his_tbl_order_warehouse_flow_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_his_tbl_order_warehouse_flow_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_his_tbl_order_warehouse_flow_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_his_tbl_order_warehouse_flow_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, origin_warehouse_code, target_warehouse_code, is_force_audit, trigger_scene, operator, create_time, update_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_his_tbl_order_warehouse_flow_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_process_snapshot_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_process_snapshot_ods AS SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, dispatch_rule, hit_strategy, man_rule_name, region, region_no, manage_city, manage_city_no, rejection_reason FROM dc_ods_kudu.yg_order_tbl_order_process_snapshot_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, NULL create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL dispatch_rule, NULL hit_strategy, NULL man_rule_name, NULL region, NULL region_no, NULL manage_city, NULL manage_city_no, NULL rejection_reason FROM dc_ods_kudu.yg_order_his_tbl_order_process_snapshot_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL dispatch_rule, NULL hit_strategy, NULL man_rule_name, NULL region, NULL region_no, NULL manage_city, NULL manage_city_no, NULL rejection_reason FROM dc_ods_kudu.yg_order_his_tbl_order_process_snapshot_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL dispatch_rule, NULL hit_strategy, NULL man_rule_name, NULL region, NULL region_no, NULL manage_city, NULL manage_city_no, NULL rejection_reason FROM dc_ods_kudu.yg_order_his_tbl_order_process_snapshot_2021_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, dispatch_rule, hit_strategy, man_rule_name, region, NULL region_no, manage_city, NULL manage_city_no, rejection_reason FROM dc_ods_kudu.yg_order_his_tbl_order_process_snapshot_2022_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, delivery_dept_name, delivery_dept_no, delivery_type, event_time, event_type, operate_user, op_timestamp, create_time, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, dispatch_rule, hit_strategy, man_rule_name, region, region_no, manage_city, manage_city_no, rejection_reason FROM dc_ods_kudu.yg_order_his_tbl_order_process_snapshot_2023_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_wms_return_qa_product_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_wms_return_qa_product_ods AS SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_his_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2016_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2017_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2011_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2012_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2013_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2014_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, return_code, return_type, return_status, express_code, express_id, CAST(express_charges AS DECIMAL(17,4)) express_charges, cash_on_delivery, warehouse_id, qa_person, qa_date, remark, is_exception, express_name, warehouse_code, warehouse_name, approver_date, cancel_person, cancel_date, sec_confirm_status, is_cancel, is_offset, cancel_id, customer_backremark, checker, lock_status, source_type, send_warehouse_code, op_timestamp, order_source_no, group_warehouse_code, group_warehouse_name, bill_type, original_order_no, original_code, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time FROM dc_ods_kudu.yg_order_tbl_wms_return_qa_product_2015_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_wph_order_info_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_wph_order_info_ods AS SELECT id, order_sub_no, order_main_no, po_no, package_no, receipt_warehouse_code, receipt_warehouse_name, estimate_arrivetime, estimate_outstoretime, schedule_id, strorage_no, old_storage_no, so_no, delivery_type, jit_biz_type, transport_type, create_time, update_time, reality_warehouse_code, reality_warehouse_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, sync_reality_warehouse_code, warehouse_type, wph_order_type, merged_code, merged_status, cooperate_code, merged_intercept_status, seller_message, quality_check_flag, priority_delivery FROM dc_ods_kudu.yg_order_tbl_order_wph_order_info_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, order_main_no, po_no, package_no, receipt_warehouse_code, receipt_warehouse_name, estimate_arrivetime, estimate_outstoretime, schedule_id, strorage_no, old_storage_no, so_no, delivery_type, jit_biz_type, transport_type, create_time, update_time, reality_warehouse_code, reality_warehouse_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL sync_reality_warehouse_code, NULL warehouse_type, NULL wph_order_type, NULL merged_code, NULL merged_status, NULL cooperate_code, NULL merged_intercept_status, NULL seller_message, NULL quality_check_flag, NULL priority_delivery FROM dc_ods_kudu.yg_order_his_tbl_order_wph_order_info_2017_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, order_main_no, po_no, package_no, receipt_warehouse_code, receipt_warehouse_name, estimate_arrivetime, estimate_outstoretime, schedule_id, strorage_no, old_storage_no, so_no, delivery_type, jit_biz_type, transport_type, create_time, update_time, reality_warehouse_code, reality_warehouse_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL sync_reality_warehouse_code, NULL warehouse_type, NULL wph_order_type, NULL merged_code, NULL merged_status, NULL cooperate_code, NULL merged_intercept_status, NULL seller_message, NULL quality_check_flag, NULL priority_delivery FROM dc_ods_kudu.yg_order_his_tbl_order_wph_order_info_2018_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, order_main_no, po_no, package_no, receipt_warehouse_code, receipt_warehouse_name, estimate_arrivetime, estimate_outstoretime, schedule_id, strorage_no, old_storage_no, so_no, delivery_type, jit_biz_type, transport_type, create_time, update_time, reality_warehouse_code, reality_warehouse_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL sync_reality_warehouse_code, NULL warehouse_type, NULL wph_order_type, NULL merged_code, NULL merged_status, NULL cooperate_code, NULL merged_intercept_status, NULL seller_message, NULL quality_check_flag, NULL priority_delivery FROM dc_ods_kudu.yg_order_his_tbl_order_wph_order_info_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_sub_no, order_main_no, po_no, package_no, receipt_warehouse_code, receipt_warehouse_name, estimate_arrivetime, estimate_outstoretime, schedule_id, strorage_no, old_storage_no, so_no, delivery_type, jit_biz_type, transport_type, create_time, update_time, reality_warehouse_code, reality_warehouse_name, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, NULL sync_reality_warehouse_code, NULL warehouse_type, NULL wph_order_type, NULL merged_code, NULL merged_status, NULL cooperate_code, NULL merged_intercept_status, NULL seller_message, NULL quality_check_flag, NULL priority_delivery FROM dc_ods_kudu.yg_order_his_tbl_order_wph_order_info_2020_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_sale_apply_bill_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_sale_apply_bill_ods AS SELECT id, order_no, sale_type, contact_phone, mobile_phone, address, facade, pack, CAST(is_bill AS DECIMAL(17,4)) is_bill, remark, customer, create_time, update_time, timpstamp, createor, apply_no, status, CAST(amount AS DECIMAL(17,4)) amount, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, integral, warehouse_code, order_sub_id, email, mail_send_flag, lock_user, zip_code, new_order_no, accept_address, logistics_company, login_name, images_path, is_deal, out_order_id, out_shop_name, express_no, bank_address, refund_way, payee_flag, account_holder, bank_account, province_code, area_code, sub_bank_info, bank_code, sale_reason, hometown_code, old_sale_apply, out_apply_no, examine_time, order_source_no, logistics_name, is_system_confirm, express_time, is_convert, is_repeat, CAST(repeat_amount AS DECIMAL(17,4)) repeat_amount, is_exception, apply_source, op_timestamp, refund_phase, cs_status, advance_status, privilege_service, is_refund_commission, loginaccount_id, dd_status, agree_date, delay_count, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, handle_type, is_new_abnoramal_bill, audit_status, repeat_type FROM dc_ods_kudu.yg_order_tbl_order_sale_apply_bill_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_no, sale_type, contact_phone, mobile_phone, address, facade, pack, CAST(is_bill AS DECIMAL(17,4)) is_bill, remark, customer, create_time, update_time, timpstamp, createor, apply_no, status, CAST(amount AS DECIMAL(17,4)) amount, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, integral, warehouse_code, order_sub_id, email, mail_send_flag, lock_user, zip_code, new_order_no, accept_address, logistics_company, login_name, images_path, is_deal, out_order_id, out_shop_name, express_no, bank_address, refund_way, payee_flag, account_holder, bank_account, province_code, area_code, sub_bank_info, bank_code, sale_reason, hometown_code, old_sale_apply, out_apply_no, examine_time, order_source_no, logistics_name, is_system_confirm, express_time, is_convert, is_repeat, CAST(repeat_amount AS DECIMAL(17,4)) repeat_amount, is_exception, apply_source, op_timestamp, refund_phase, cs_status, advance_status, privilege_service, is_refund_commission, loginaccount_id, dd_status, agree_date, delay_count, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, handle_type, is_new_abnoramal_bill, audit_status, repeat_type FROM dc_ods_kudu.yg_order_tbl_order_sale_apply_bill_his_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, order_no, sale_type, contact_phone, mobile_phone, address, facade, pack, CAST(is_bill AS DECIMAL(17,4)) is_bill, remark, customer, create_time, update_time, timpstamp, createor, apply_no, status, CAST(amount AS DECIMAL(17,4)) amount, CAST(discount_amount AS DECIMAL(17,4)) discount_amount, integral, warehouse_code, order_sub_id, email, mail_send_flag, lock_user, zip_code, new_order_no, accept_address, logistics_company, login_name, images_path, is_deal, out_order_id, out_shop_name, express_no, bank_address, refund_way, payee_flag, account_holder, bank_account, province_code, area_code, sub_bank_info, bank_code, sale_reason, hometown_code, old_sale_apply, out_apply_no, examine_time, order_source_no, logistics_name, is_system_confirm, express_time, is_convert, is_repeat, CAST(repeat_amount AS DECIMAL(17,4)) repeat_amount, is_exception, apply_source, op_timestamp, refund_phase, cs_status, advance_status, privilege_service, is_refund_commission, loginaccount_id, dd_status, agree_date, delay_count, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, handle_type, is_new_abnoramal_bill, audit_status, repeat_type FROM dc_ods_kudu.yg_order_tbl_order_sale_apply_bill_2011_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL

-- show create view dc_ods_view.yg_order_tbl_order_cancel_goods_info_ods;
result
CREATE VIEW dc_ods_view.yg_order_tbl_order_cancel_goods_info_ods AS SELECT id, apply_id, prod_code, commodity_name, commodity_num, CAST(disscount_amount AS DECIMAL(17,4)) disscount_amount, CAST(commodity_amount AS DECIMAL(17,4)) commodity_amount, discount_plan, units, specification, CAST(unit_price AS DECIMAL(17,4)) unit_price, level_code, commodity_id, order_detail14_sub_id, out_register_sys_no, CAST(union_returns_amount AS DECIMAL(17,4)) union_returns_amount, reject_prodcut_no, site_no, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp FROM dc_ods_kudu.yg_order_tbl_order_cancel_goods_info_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, apply_id, prod_code, commodity_name, commodity_num, CAST(disscount_amount AS DECIMAL(17,4)) disscount_amount, CAST(commodity_amount AS DECIMAL(17,4)) commodity_amount, discount_plan, units, specification, CAST(unit_price AS DECIMAL(17,4)) unit_price, level_code, commodity_id, order_detail14_sub_id, out_register_sys_no, CAST(union_returns_amount AS DECIMAL(17,4)) union_returns_amount, reject_prodcut_no, site_no, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp FROM dc_ods_kudu.yg_order_tbl_order_cancel_goods_info_his_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL UNION ALL SELECT id, apply_id, prod_code, commodity_name, commodity_num, CAST(disscount_amount AS DECIMAL(17,4)) disscount_amount, CAST(commodity_amount AS DECIMAL(17,4)) commodity_amount, discount_plan, units, specification, CAST(unit_price AS DECIMAL(17,4)) unit_price, level_code, commodity_id, order_detail14_sub_id, out_register_sys_no, CAST(union_returns_amount AS DECIMAL(17,4)) union_returns_amount, reject_prodcut_no, site_no, from_unixtime(unix_timestamp(), 'yyyy-MM-dd HH:mm:ss') ods_update_time, op_timestamp FROM dc_ods_kudu.yg_order_tbl_order_cancel_goods_info_2011_2019_ods WHERE etl_flag IN ('1', '2') OR etl_flag IS NULL
